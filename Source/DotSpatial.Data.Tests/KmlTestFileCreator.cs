using System;
using System.IO;
using System.IO.Compression;

namespace DotSpatial.Data.Tests
{
    public class KmlTestFileCreator
    {
        private static string kmlFilename = "KmlTestFile.kml";
        private static string kmzFilename = "KmzTestFile.kmz";
        public static string CreateKmlTestFile()
        {
            var fullfilename = $"{Directory.GetCurrentDirectory()}\\{kmlFilename}";
            File.WriteAllText(fullfilename, @"<?xml version=""1.0"" encoding=""UTF-8""?>
<kml xmlns=""http://www.opengis.net/kml/2.2"" xmlns:gx=""http://www.google.com/kml/ext/2.2"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""
 xsi:schemaLocation=""http://www.opengis.net/kml/2.2 http://schemas.opengis.net/kml/2.2.0/ogckml22.xsd http://www.google.com/kml/ext/2.2 http://code.google.com/apis/kml/schema/kml22gx.xsd"">
<Document id=""PE_Vassununga"">
  <name>PE_Vassununga</name>
  <Snippet></Snippet>
  <Folder id=""FeatureLayer0"">
    <name>PE_Vassununga</name>
    <Snippet></Snippet>
    <Placemark id=""ID_00000"">
      <name>Parque Estadual</name>
      <Snippet></Snippet>
      <description><![CDATA[<html xmlns:fo=""http://www.w3.org/1999/XSL/Format"" xmlns:msxsl=""urn:schemas-microsoft-com:xslt"">
<head>
<META http-equiv=""Content-Type"" content=""text/html"">
<meta http-equiv=""content-type"" content=""text/html; charset=UTF-8"">
</head>
<body style=""margin:0px 0px 0px 0px;overflow:auto;background:#FFFFFF;"">
<table style=""font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-collapse:collapse;padding:3px 3px 3px 3px"">
<tr style=""text-align:center;font-weight:bold;background:#9CBCE2"">
<td>Parque Estadual</td>
</tr>
<tr>
<td>
<table style=""font-family:Arial,Verdana,Times;font-size:12px;text-align:left;width:100%;border-spacing:0px; padding:3px 3px 3px 3px"">
<tr>
<td>FID</td>
<td>0</td>
</tr>
<tr bgcolor=""#D4E4F3"">
<td>CATEGORIA</td>
<td>Parque Estadual</td>
</tr>
<tr>
<td>UNIDADE</td>
<td>PE Vassununga</td>
</tr>
<tr bgcolor=""#D4E4F3"">
<td>Ordem</td>
<td>27</td>
</tr>
<tr>
<td>Area_ha</td>
<td>2050,971463</td>
</tr>
<tr bgcolor=""#D4E4F3"">
<td>perim</td>
<td>41,933791</td>
</tr>
</table>
</td>
</tr>
</table>
</body>
</html>
]]></description>
      <styleUrl>#PolyStyle00</styleUrl>
      <MultiGeometry>
        <Polygon>
          <extrude>0</extrude><altitudeMode>clampToGround</altitudeMode><tessellate>1</tessellate>
          <outerBoundaryIs><LinearRing><coordinates> -47.61607098731566,-21.6161403350719,0 -47.61805354791956,-21.61025003287248,0 -47.63284624140933,-21.61017918080665,0 -47.65376233130422,-21.64044340791257,0 -47.65326998544061,-21.64207876117544,0 -47.63334476796664,-21.64727845038808,0 -47.63087575038961,-21.64552733588855,0 -47.61133347755526,-21.6430690437385,0 -47.61607098731566,-21.6161403350719,0</coordinates></LinearRing></outerBoundaryIs>
        </Polygon>
        <Polygon>
          <extrude>0</extrude><altitudeMode>clampToGround</altitudeMode><tessellate>1</tessellate>
          <outerBoundaryIs><LinearRing><coordinates> -47.61670306109561,-21.68761310065907,0 -47.63067411727491,-21.68581541138695,0 -47.63092378368987,-21.68770608746757,0 -47.63036110058863,-21.68839772176305,0 -47.63064200831126,-21.6901361396253,0 -47.62818205902322,-21.69243959225361,0 -47.62715921096854,-21.692661919747,0 -47.62654860768022,-21.69283347112912,0 -47.62536583135085,-21.69317586847791,0 -47.62444980214242,-21.6934241140383,0 -47.62385971377299,-21.69366728540966,0 -47.62361175407889,-21.6937430746438,0 -47.62335307061062,-21.69382214114883,0 -47.62267605101065,-21.69437805913866,0 -47.62185162198927,-21.69483019970237,0 -47.62150010564065,-21.69498102304164,0 -47.62104214564087,-21.69514869640724,0 -47.62039350641355,-21.6953387940624,0 -47.61935657333606,-21.69526526536014,0 -47.61833365624022,-21.69490378106742,0 -47.61791018241476,-21.69482055018085,0 -47.61633244387204,-21.69500797134068,0 -47.61540249867849,-21.69507591538946,0 -47.61471161197976,-21.69505088448097,0 -47.61414071421518,-21.69529363000585,0 -47.61360806075461,-21.69553586088124,0 -47.61305173695507,-21.69552657687908,0 -47.61223933391029,-21.69514376836688,0 -47.61143115214141,-21.69499471934462,0 -47.61064705283758,-21.6951149593319,0 -47.61018977849223,-21.69528403742856,0 -47.60991564265748,-21.6952160387234,0 -47.6097023094343,-21.69510726773464,0 -47.60946594168651,-21.69476033380898,0 -47.60928713518934,-21.69441249323875,0 -47.60919593564864,-21.6941442563198,0 -47.60907425395316,-21.69377664711115,0 -47.60871995266766,-21.69326978256082,0 -47.60859035276627,-21.69246262328946,0 -47.60895059092986,-21.69170165297044,0 -47.60940144137638,-21.69118202439513,0 -47.61011704045794,-21.69098197786957,0 -47.61181133150255,-21.69082040887003,0 -47.61492057776436,-21.6909601680291,0 -47.61670306109561,-21.68761310065907,0</coordinates></LinearRing></outerBoundaryIs>
        </Polygon>
        <Polygon>
          <extrude>0</extrude><altitudeMode>clampToGround</altitudeMode><tessellate>1</tessellate>
          <outerBoundaryIs><LinearRing><coordinates> -47.646976047276,-21.73524712440824,0 -47.64688449808061,-21.73446441854898,0 -47.64686132708888,-21.73426631459408,0 -47.64572177618597,-21.73121000514502,0 -47.64551763552117,-21.73019328605845,0 -47.64537961327372,-21.72831748939953,0 -47.64570492206693,-21.72695429985575,0 -47.64580748633939,-21.72630237440398,0 -47.64598040266468,-21.72606795239438,0 -47.64637393006821,-21.72532804754174,0 -47.64673923951055,-21.72529512346418,0 -47.64730567229497,-21.72535991535957,0 -47.64832761667154,-21.72564248633224,0 -47.64844669520478,-21.72569204078298,0 -47.64858610280188,-21.72580166705602,0 -47.64886127238825,-21.72583779990898,0 -47.65022936463779,-21.72627515612026,0 -47.65008552851045,-21.72691997929652,0 -47.64958598958596,-21.7284170490307,0 -47.64910148838941,-21.73024455022476,0 -47.64921267806071,-21.73031167557512,0 -47.64923407059741,-21.73036271769508,0 -47.64956511978602,-21.73047747520462,0 -47.65453560613545,-21.73193055023186,0 -47.66085501434793,-21.73403906052752,0 -47.66009325573756,-21.73693870217105,0 -47.65950060624776,-21.73919437178462,0 -47.65910702113428,-21.73908396664544,0 -47.65899815487062,-21.73905342820833,0 -47.65749186012653,-21.73905990104748,0 -47.65565861892536,-21.73896330474927,0 -47.65480701822468,-21.73881175947537,0 -47.65323863336757,-21.73849349331631,0 -47.65190254991344,-21.73782752394708,0 -47.65102475661848,-21.73744354706866,0 -47.65027411974508,-21.73716938500025,0 -47.65014651223378,-21.73712277726517,0 -47.64862487280831,-21.73692982758692,0 -47.64839700958783,-21.73687145249007,0 -47.64795847008413,-21.73664852818292,0 -47.64772969077991,-21.73648742843844,0 -47.64747539197938,-21.73620982435385,0 -47.64713836849406,-21.73569439203287,0 -47.646976047276,-21.73524712440824,0</coordinates></LinearRing></outerBoundaryIs>
        </Polygon>
        <Polygon>
          <extrude>0</extrude><altitudeMode>clampToGround</altitudeMode><tessellate>1</tessellate>
          <outerBoundaryIs><LinearRing><coordinates> -47.58680570735852,-21.72724002117585,0 -47.58595363282369,-21.72694790630436,0 -47.58480123301134,-21.73013962583094,0 -47.5844798727706,-21.73102734172,0 -47.58442236376583,-21.73101036363319,0 -47.58398683193621,-21.73085808467346,0 -47.58366868956062,-21.73065079537438,0 -47.58349861925111,-21.73046159829269,0 -47.58343395506629,-21.73023897620305,0 -47.58342973594306,-21.73006244820052,0 -47.58347044095274,-21.72985840493677,0 -47.58354585013151,-21.72956868299103,0 -47.58352332240032,-21.72937339100156,0 -47.58343581618811,-21.72924592268402,0 -47.5831969741884,-21.72907441051954,0 -47.58312933650285,-21.72899348890721,0 -47.58301256650812,-21.72863977588502,0 -47.58282073729449,-21.72828181688876,0 -47.58275787719175,-21.72815459552313,0 -47.58273834138989,-21.72802389939113,0 -47.58280352426223,-21.72758365456481,0 -47.58274574533679,-21.72744335309822,0 -47.58260827119662,-21.72737462558141,0 -47.58199004336372,-21.72721237015364,0 -47.58188352920304,-21.72715661129648,0 -47.58178429216336,-21.72703221386892,0 -47.58173947035418,-21.7267733484939,0 -47.58184679811983,-21.72638788044912,0 -47.58188868674016,-21.72612558623497,0 -47.58182130358065,-21.72602633241374,0 -47.58172174282738,-21.72598653534945,0 -47.58065879875025,-21.72589756728679,0 -47.58023879605017,-21.72581301804804,0 -47.58004645163398,-21.72570162676555,0 -47.57988566655919,-21.72544194953403,0 -47.57976510001529,-21.72518886805539,0 -47.57969883508264,-21.72500057635013,0 -47.57967715568697,-21.72478206720746,0 -47.57983944865849,-21.72426555494858,0 -47.57984390104444,-21.72404943740664,0 -47.57977412116441,-21.72392403769394,0 -47.57940284261004,-21.72361310830025,0 -47.57936086005886,-21.72353467408557,0 -47.57937501914545,-21.72344010731832,0 -47.5795500029827,-21.7230283069349,0 -47.57952944805722,-21.72279154291781,0 -47.57943779419547,-21.7226315440788,0 -47.57933075779439,-21.72255168564695,0 -47.57886503893763,-21.72244418993001,0 -47.5786889705961,-21.72235655846281,0 -47.57857249382841,-21.7222024529298,0 -47.57851113132534,-21.72198546423882,0 -47.57845846777842,-21.72136233519125,0 -47.5783860729229,-21.72112267646847,0 -47.57831169145265,-21.72100457021582,0 -47.5781697160813,-21.72090512169096,0 -47.57780503862928,-21.72088786750691,0 -47.57753157692176,-21.72080572327795,0 -47.57738604108802,-21.72069621768305,0 -47.5771677272923,-21.7204500719767,0 -47.57730885116834,-21.72023625076905,0 -47.57771655556938,-21.71984881753574,0 -47.5779057532494,-21.71951335789252,0 -47.57795008047212,-21.71908941858401,0 -47.57790913202494,-21.71803924591745,0 -47.57798115394196,-21.71773251491196,0 -47.57823614812052,-21.71730493472057,0 -47.57883842612864,-21.71670013708047,0 -47.57910349736714,-21.71636647435682,0 -47.57922520746759,-21.71608840163579,0 -47.57937915796411,-21.71540237731673,0 -47.57944535985444,-21.7139841661806,0 -47.57951232557482,-21.71364880341879,0 -47.57958769733635,-21.71280970834119,0 -47.57972536727015,-21.71227823197907,0 -47.58010844935672,-21.71149239626532,0 -47.58063994697536,-21.71021464048939,0 -47.58108664840137,-21.70948062790854,0 -47.58171198614697,-21.70894678764222,0 -47.5820146111644,-21.70861795345804,0 -47.58225236705347,-21.70836271787735,0 -47.58327616759033,-21.70747895202957,0 -47.5835432960853,-21.70720240142257,0 -47.58379635036059,-21.70684653035082,0 -47.58407841838466,-21.70625438637589,0 -47.58448283432922,-21.70567513996012,0 -47.58598595041389,-21.70418882517517,0 -47.586530023492,-21.70345111467652,0 -47.58672908546711,-21.70326428063686,0 -47.58680569802189,-21.7032210125521,0 -47.58694470923822,-21.7032148697024,0 -47.58707000234038,-21.70328441768938,0 -47.58760854155594,-21.70372877801454,0 -47.58768439507481,-21.70383214123667,0 -47.58771494402102,-21.7039412678679,0 -47.58769758771253,-21.70448874516935,0 -47.58788683037938,-21.70493585080133,0 -47.5879967105253,-21.70528325930356,0 -47.58806267108374,-21.70606489334487,0 -47.58804228627344,-21.70627015448251,0 -47.5878899452272,-21.70694631724348,0 -47.58788144014861,-21.70714597580841,0 -47.58800117097191,-21.70769284617559,0 -47.58806914376046,-21.70787939256053,0 -47.58820983198438,-21.7080747339575,0 -47.58839497734095,-21.70824924742821,0 -47.58890659337113,-21.70863470614394,0 -47.5892885522321,-21.70910642382217,0 -47.5895100413532,-21.71303216822455,0 -47.58976154695537,-21.71643686899742,0 -47.58991031048278,-21.71600353179876,0 -47.59262835429138,-21.71579461149197,0 -47.59326729090039,-21.71574551522799,0 -47.59443963910824,-21.71563037033005,0 -47.5972616446303,-21.71534724931905,0 -47.59751098883906,-21.71727105155471,0 -47.59777447911761,-21.71930405297469,0 -47.59779988394786,-21.71983063336424,0 -47.59780022044588,-21.719837608094,0 -47.59795407073331,-21.72053909860128,0 -47.59808983310914,-21.72164699141297,0 -47.59826905686961,-21.72194193057101,0 -47.59887946529783,-21.72204068938451,0 -47.60007412738537,-21.7224009384375,0 -47.60141281336996,-21.72270483637665,0 -47.60257762783515,-21.7230113659449,0 -47.60376694229313,-21.72307392031087,0 -47.60431793535006,-21.72309233877138,0 -47.60559233107725,-21.72304520304406,0 -47.6062257716358,-21.72281864637843,0 -47.60685930656671,-21.72259208595802,0 -47.60832082184474,-21.72167563792829,0 -47.6087790101591,-21.72137057927921,0 -47.60952991436074,-21.72122341384163,0 -47.61025027480536,-21.72099547297925,0 -47.61117064530131,-21.72060195816944,0 -47.61223384804584,-21.72009784726449,0 -47.61277983892054,-21.71984556241467,0 -47.61315459764026,-21.71973131054153,0 -47.61364468371235,-21.71958824331923,0 -47.61416129868882,-21.71930933343635,0 -47.61424676560601,-21.71922682092735,0 -47.61435768636876,-21.71895431507253,0 -47.61440095975001,-21.71814145823852,0 -47.61455916286299,-21.71727252756939,0 -47.61463630782823,-21.71672989055738,0 -47.61509301640301,-21.71672394304311,0 -47.61619825547029,-21.71660708603975,0 -47.61642759297047,-21.71664779103404,0 -47.61653665604337,-21.71684423584237,0 -47.6167972810679,-21.71811714981612,0 -47.61691359815763,-21.71832458420487,0 -47.6170541135261,-21.71838492860693,0 -47.61817217035711,-21.71856984631688,0 -47.61861959217531,-21.71870171456384,0 -47.61901406295008,-21.71887071215002,0 -47.6193059629374,-21.71910588242035,0 -47.6194101663158,-21.71930041548142,0 -47.61946769296085,-21.71963842169341,0 -47.6197561132928,-21.72301895730903,0 -47.61870448162345,-21.72355850395652,0 -47.61823947526619,-21.7238116043774,0 -47.61742465160815,-21.72457490772559,0 -47.61738438187843,-21.72464018589261,0 -47.61695298644784,-21.72446590105614,0 -47.61617678225727,-21.72430997441918,0 -47.61534874080058,-21.72434896819576,0 -47.61419568554187,-21.72474229951307,0 -47.61390525828659,-21.72487734222666,0 -47.61375578217708,-21.72504311196312,0 -47.61348460329418,-21.72543045811419,0 -47.61300578644542,-21.72626201700047,0 -47.61263197923729,-21.72679326587821,0 -47.61243140286265,-21.72702953860523,0 -47.61221664132281,-21.72720274752619,0 -47.61194739750884,-21.72735009249123,0 -47.61157285004927,-21.72747715995163,0 -47.61079242582961,-21.72761252441672,0 -47.60905562976934,-21.72769145855049,0 -47.60834276482303,-21.72775306997379,0 -47.60674971919845,-21.72823769911627,0 -47.60607713929685,-21.72858305492595,0 -47.60534362728364,-21.72889867142001,0 -47.60471155611511,-21.72909550257457,0 -47.60378862015531,-21.72938285567215,0 -47.60229806608217,-21.73006093205858,0 -47.60048983225326,-21.7308976479321,0 -47.5993124428943,-21.73144790495471,0 -47.59816970457393,-21.73206098858036,0 -47.59710038905767,-21.73263607771164,0 -47.59686701992342,-21.73273254987614,0 -47.59677730625396,-21.73275183344855,0 -47.59666699907076,-21.73277586386273,0 -47.59092454069025,-21.73019737189167,0 -47.59136199676499,-21.72944379519509,0 -47.59142898844886,-21.72928908517381,0 -47.59156603913866,-21.72908606040959,0 -47.59183457462532,-21.72882229307515,0 -47.59186219410299,-21.72879516393843,0 -47.59181794418731,-21.72873552091623,0 -47.59166517253721,-21.72867615949059,0 -47.58990762275238,-21.72824647523876,0 -47.58954237370146,-21.7281821299446,0 -47.58816500072975,-21.72802933485405,0 -47.58779880483371,-21.72794983285848,0 -47.58742183564763,-21.72775972120615,0 -47.58680570735852,-21.72724002117585,0</coordinates></LinearRing></outerBoundaryIs>
        </Polygon>
        <Polygon>
          <extrude>0</extrude><altitudeMode>clampToGround</altitudeMode><tessellate>1</tessellate>
          <outerBoundaryIs><LinearRing><coordinates> -47.61150467733979,-21.73314675187378,0 -47.61146651786648,-21.73261270595355,0 -47.61165638853694,-21.73206170022766,0 -47.61201613236398,-21.7314412052024,0 -47.61211432810477,-21.73134612372252,0 -47.61192812835824,-21.73130897714951,0 -47.61169816666586,-21.73121898386854,0 -47.61150882841859,-21.73100818436605,0 -47.61189286626076,-21.73093522583885,0 -47.61232105213188,-21.73094183005167,0 -47.61314486480417,-21.73112094506324,0 -47.61382149612909,-21.73149675636763,0 -47.61427197540052,-21.73181682191114,0 -47.6147787708341,-21.73205564580959,0 -47.6160418914255,-21.73272688030005,0 -47.61698886650297,-21.73430591718245,0 -47.61225084010913,-21.73623443432559,0 -47.61257883511542,-21.73572286700576,0 -47.61286922112792,-21.73521035822008,0 -47.61280246047335,-21.73467676474814,0 -47.61252389783609,-21.73426676991924,0 -47.61190031783126,-21.73371524141436,0 -47.6117398484859,-21.73355680168338,0 -47.61150467733979,-21.73314675187378,0</coordinates></LinearRing></outerBoundaryIs>
        </Polygon>
      </MultiGeometry>
    </Placemark>
  </Folder>
  <Style id=""PolyStyle00"">
    <LabelStyle>
      <color>00000000</color>
      <scale>0.000000</scale>
    </LabelStyle>
    <LineStyle>
      <color>ff00ffff</color>
      <width>3.000000</width>
    </LineStyle>
    <PolyStyle>
      <color>00d8e9ec</color>
      <outline>1</outline>
    </PolyStyle>
  </Style>
</Document>
</kml>");
            return fullfilename;
        }

        internal static string CreateKmzTestFile()
        {
            var fullfilename = $"{Directory.GetCurrentDirectory()}\\{kmzFilename}";
            var kmlFile = CreateKmlTestFile();

            using (var kmlFileStream = File.Open(kmlFile, FileMode.Open))
            using (var kmzFileStream = File.Create(fullfilename))
            using (var zip = new ZipArchive(kmzFileStream, ZipArchiveMode.Create))
            {
                var ent = zip.CreateEntry("doc.kml");
                kmlFileStream.CopyTo(ent.Open());
            }

            DeleteKmlTestFile();
            return fullfilename;
        }

        internal static void DeleteKmlTestFile()
        {
            var fullfilename = $"{Directory.GetCurrentDirectory()}\\{kmlFilename}";
            File.Delete(fullfilename);
        }

        internal static void DeleteKmzTestFile()
        {
            var fullfilename = $"{Directory.GetCurrentDirectory()}\\{kmzFilename}";
            File.Delete(fullfilename);
        }
    }
}